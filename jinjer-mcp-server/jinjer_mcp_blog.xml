<?xml version="1.0" encoding="UTF-8" ?>
<!-- This is a WordPress eXtended RSS file generated by Claude Code -->
<rss version="2.0"
	xmlns:excerpt="http://wordpress.org/export/1.2/excerpt/"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:wp="http://wordpress.org/export/1.2/"
>

<channel>
	<title>Technical Blog Export</title>
	<link>http://example.com</link>
	<description>Exported from Claude Code</description>
	<pubDate>Thu, 19 Feb 2026 00:00:00 +0000</pubDate>
	<language>ja</language>
	<wp:wxr_version>1.2</wp:wxr_version>
	<wp:base_site_url>http://example.com</wp:base_site_url>
	<wp:base_blog_url>http://example.com</wp:base_blog_url>

	<item>
		<title>社内システムと会話する！Jinjer APIのMCPサーバーを自作してClaude Desktopと連携させてみた</title>
		<link>http://example.com/?p=123</link>
		<pubDate>Thu, 19 Feb 2026 00:00:00 +0000</pubDate>
		<dc:creator><![CDATA[admin]]></dc:creator>
		<guid isPermaLink="false">http://example.com/?p=123</guid>
		<description></description>
		<content:encoded><![CDATA[
<h3>はじめに</h3>
<p>最近話題の <strong>Model Context Protocol (MCP)</strong> 。これを使うと、Claude DesktopなどのAIアシスタントがローカルツールや外部APIと直接会話できるようになります。</p>

<p>今回は、バックオフィス向けクラウドサービス <strong>「Jinjer」のAPI</strong> をMCPサーバー化し、Claude Desktopから従業員情報を直接検索・取得できるようにした過程を共有します。</p>

<h3>今回の成果物</h3>
<p>Claude Desktopに「退職済みの従業員リストをちょうだい」や「2024年に入社した山田さんを探して」と頼むだけで、Jinjerから最新データを取得して回答してくれるようになります。</p>

<h3>使用した技術スタック</h3>
<ul>
<li><strong>Python 3.12+</strong></li>
<li><strong>uv</strong>: 高速なPythonパッケージ管理ツール</li>
<li><strong>FastMCP</strong>: MCPサーバーを簡単に書くためのライブラリ (<code>mcp</code> パッケージに含まれます)</li>
<li><strong>Jinjer API</strong>: 今回の連携先</li>
</ul>

<hr />

<h3>1. プロジェクトのセットアップ (uvを使用)</h3>

<p>今回はパッケージ管理に <code>uv</code> を使用しました。セットアップが爆速で快適です。</p>

<pre><code class="language-bash"># プロジェクト作成
mkdir jinjer-mcp-server
cd jinjer-mcp-server
uv init .

# 必要なライブラリのインストール
uv add "mcp[cli]" httpx
</code></pre>

<h3>2. 認証ロジックの実装</h3>

<p>Jinjer APIは少し特殊で、APIキーとシークレットキーを使って一時的な「アクセストークン」を取得し、それを使って各エンドポイントを叩く仕組みです。
毎回トークンを取りに行くと効率が悪いので、有効期限内（4時間）は使い回すロジックを実装しました。</p>

<pre><code class="language-python"># server.py (抜粋)
def _get_token(self) -> str:
    current_time = time.time()
    # トークンがあり、有効期限切れまで余裕があれば再利用
    if self.access_token and current_time < self.token_expiry - 300:
        return self.access_token

    # 新しいトークンを取得 (/v2/token)
    response = self.client.get(...)
    # ... (エラー処理とトークン保存)
    return self.access_token
</code></pre>

<h3>3. MCPツールの実装</h3>

<p><code>FastMCP</code> を使うと、デコレータをつけるだけで関数をMCPツールとして公開できます。</p>

<h4>従業員ID一覧の取得 (<code>list_employee_ids</code>)</h4>
<p>まずは基本のID一覧取得です。</p>

<pre><code class="language-python">@mcp.tool()
def list_employee_ids(
    page: int = 1,
    employee_id: Optional[str] = None,
    # ... 他のパラメータ
) -> str:
    """従業員ID一覧を取得します"""
    # ... APIリクエスト処理
</code></pre>

<h4>従業員詳細情報の取得 (<code>list_employees</code>)</h4>
<p>次に、より詳細な情報（氏名、入社日など）を取得するツールも追加しました。検索パラメータを豊富に用意することで、Claudeが柔軟に検索できるようになります。</p>

<pre><code class="language-python">@mcp.tool()
def list_employees(
    employee_last_name: Optional[str] = None, # 名字で検索
    has_since_changed_at: Optional[str] = None, # 更新日で絞り込み
    # ...
) -> str:
    """従業員情報を取得します"""
    # ...
</code></pre>

<h3>4. Claude Desktopへの登録</h3>

<p>作成したサーバーをClaude Desktopに認識させるため、設定ファイル (<code>claude_desktop_config.json</code>) を編集します。
<code>uv</code> 経由で実行する設定にしておけば、仮想環境のパスを気にせず実行できて便利です。</p>

<pre><code class="language-json">{
  "mcpServers": {
    "jinjer": {
      "command": "uv",
      "args": [
        "--directory",
        "C:/path/to/jinjer-mcp-server",
        "run",
        "server.py"
      ],
      "env": {
        "JINJER_API_KEY": "YOUR_API_KEY",
        "JINJER_SECRET_KEY": "YOUR_SECRET_KEY"
      }
    }
  }
}
</code></pre>

<h3>5. 実際に動かしてみる</h3>

<p>設定を保存してClaude Desktopを再起動すると、チャット入力欄の右側にツールアイコン（コンセントのマーク）が表示されます。</p>

<p><strong>ユーザー</strong>: 「2023年以降に入社した、田中という名前の従業員を探して」</p>

<p><strong>Claude</strong>: (ツール <code>list_employees</code> を実行...)<br />
「以下の従業員が見つかりました：<br />
1. 田中 太郎 (2023-04-01 入社)<br />
2. 田中 花子 (2023-10-01 入社)」</p>

<p>このように、自然言語で社内システムのDBを検索できるようになりました！</p>

<h3>まとめ</h3>
<p>MCPを使うことで、独自のAPIを驚くほど簡単にLLMと連携させることができました。
特に <code>FastMCP</code> と <code>uv</code> の組み合わせは開発体験が良く、サクッとツールを作るのに最適です。</p>

<p>次は勤怠データ取得なども実装して、さらに便利にしてみたいと思います。</p>

<hr />

<p><strong>Tips:</strong></p>
<ul>
<li>ブログ投稿時は、コードブロックにシンタックスハイライトを効かせると読みやすくなります。</li>
<li>もし可能なら、実際のClaude Desktopのスクリーンショット（プライバシー情報は隠して）を貼ると、動作イメージが伝わりやすくなります。</li>
</ul>
		]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>123</wp:post_id>
		<wp:post_date>2026-02-19 10:00:00</wp:post_date>
		<wp:post_date_gmt>2026-02-19 10:00:00</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>jinjer-mcp-server-claude-desktop</wp:post_name>
		<wp:status>draft</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="category" nicename="technical"><![CDATA[Technical]]></category>
		<category domain="category" nicename="mcp"><![CDATA[MCP]]></category>
		<category domain="post_tag" nicename="claude"><![CDATA[Claude]]></category>
		<category domain="post_tag" nicename="jinjer"><![CDATA[Jinjer]]></category>
		<category domain="post_tag" nicename="python"><![CDATA[Python]]></category>
	</item>
</channel>
</rss>
